<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex">

	<title>File src/JS.php</title>

	<link rel="stylesheet" href="resources/style.css?e99947befd7bf673c6b43ff75e9e0f170c88a60e">

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
				<h3>Namespaces</h3>
			<ul>
				<li>
					<a href="namespace-MatthiasMullie.html">
						MatthiasMullie<span></span>
					</a>

						<ul>
				<li>
					<a href="namespace-MatthiasMullie.Minify.html">
						Minify<span></span>
					</a>

						<ul>
				<li>
					<a href="namespace-MatthiasMullie.Minify.Exceptions.html">
						Exceptions					</a>

						</li>
							</ul></li></ul></li>
				<li>
					<a href="namespace-None.html">
						None					</a>

						</li>
			</ul>
		</div>

		<hr>


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-CommonTest.html">CommonTest</a></li>
				<li><a href="class-CSSTest.html">CSSTest</a></li>
				<li><a href="class-JSTest.html">JSTest</a></li>
				<li><a href="class-MatthiasMullie.Minify.CSS.html">MatthiasMullie\Minify\CSS</a></li>
				<li><a href="class-MatthiasMullie.Minify.JS.html">MatthiasMullie\Minify\JS</a></li>
				<li><a href="class-MatthiasMullie.Minify.Minify.html">MatthiasMullie\Minify\Minify</a></li>
			</ul>



			<h3>Exceptions</h3>
			<ul>
				<li><a href="class-MatthiasMullie.Minify.Exception.html" class="deprecated">MatthiasMullie\Minify\Exception</a></li>
				<li><a href="class-MatthiasMullie.Minify.Exceptions.BasicException.html">MatthiasMullie\Minify\Exceptions\BasicException</a></li>
				<li><a href="class-MatthiasMullie.Minify.Exceptions.FileImportException.html">MatthiasMullie\Minify\Exceptions\FileImportException</a></li>
				<li><a href="class-MatthiasMullie.Minify.Exceptions.IOException.html">MatthiasMullie\Minify\Exceptions\IOException</a></li>
			</ul>


		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text" placeholder="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
<span>Namespace</span>			</li>
			<li>
<span>Class</span>			</li>
		</ul>
		<ul>
		</ul>
		<ul>
		</ul>
	</div>

<pre><code><span id="1" class="l"><a href="#1">  1: </a><span class="xlang">&lt;?php</span>
</span><span id="2" class="l"><a href="#2">  2: </a>
</span><span id="3" class="l"><a href="#3">  3: </a><span class="php-keyword1">namespace</span> MatthiasMullie\Minify;
</span><span id="4" class="l"><a href="#4">  4: </a>
</span><span id="5" class="l"><a href="#5">  5: </a><span class="php-comment">/**
</span></span><span id="6" class="l"><a href="#6">  6: </a><span class="php-comment"> * JavaScript minifier.
</span></span><span id="7" class="l"><a href="#7">  7: </a><span class="php-comment"> *
</span></span><span id="8" class="l"><a href="#8">  8: </a><span class="php-comment"> * Please report bugs on https://github.com/matthiasmullie/minify/issues
</span></span><span id="9" class="l"><a href="#9">  9: </a><span class="php-comment"> *
</span></span><span id="10" class="l"><a href="#10"> 10: </a><span class="php-comment"> * @author Matthias Mullie &lt;minify@mullie.eu&gt;
</span></span><span id="11" class="l"><a href="#11"> 11: </a><span class="php-comment"> * @author Tijs Verkoyen &lt;minify@verkoyen.eu&gt;
</span></span><span id="12" class="l"><a href="#12"> 12: </a><span class="php-comment"> * @copyright Copyright (c) 2012, Matthias Mullie. All rights reserved.
</span></span><span id="13" class="l"><a href="#13"> 13: </a><span class="php-comment"> * @license MIT License
</span></span><span id="14" class="l"><a href="#14"> 14: </a><span class="php-comment"> */</span>
</span><span id="15" class="l"><a href="#15"> 15: </a><span class="php-keyword1">class</span> JS <span class="php-keyword1">extends</span> Minify
</span><span id="16" class="l"><a href="#16"> 16: </a>{
</span><span id="17" class="l"><a href="#17"> 17: </a>    <span class="php-comment">/**
</span></span><span id="18" class="l"><a href="#18"> 18: </a><span class="php-comment">     * Var-matching regex based on http://stackoverflow.com/a/9337047/802993.
</span></span><span id="19" class="l"><a href="#19"> 19: </a><span class="php-comment">     *
</span></span><span id="20" class="l"><a href="#20"> 20: </a><span class="php-comment">     * Note that regular expressions using that bit must have the PCRE_UTF8
</span></span><span id="21" class="l"><a href="#21"> 21: </a><span class="php-comment">     * pattern modifier (/u) set.
</span></span><span id="22" class="l"><a href="#22"> 22: </a><span class="php-comment">     *
</span></span><span id="23" class="l"><a href="#23"> 23: </a><span class="php-comment">     * @var string
</span></span><span id="24" class="l"><a href="#24"> 24: </a><span class="php-comment">     */</span>
</span><span id="25" class="l"><a href="#25"> 25: </a>    <span class="php-keyword1">const</span> REGEX_VARIABLE = <span class="php-quote">'\b[$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\x{02c1}\x{02c6}-\x{02d1}\x{02e0}-\x{02e4}\x{02ec}\x{02ee}\x{0370}-\x{0374}\x{0376}\x{0377}\x{037a}-\x{037d}\x{0386}\x{0388}-\x{038a}\x{038c}\x{038e}-\x{03a1}\x{03a3}-\x{03f5}\x{03f7}-\x{0481}\x{048a}-\x{0527}\x{0531}-\x{0556}\x{0559}\x{0561}-\x{0587}\x{05d0}-\x{05ea}\x{05f0}-\x{05f2}\x{0620}-\x{064a}\x{066e}\x{066f}\x{0671}-\x{06d3}\x{06d5}\x{06e5}\x{06e6}\x{06ee}\x{06ef}\x{06fa}-\x{06fc}\x{06ff}\x{0710}\x{0712}-\x{072f}\x{074d}-\x{07a5}\x{07b1}\x{07ca}-\x{07ea}\x{07f4}\x{07f5}\x{07fa}\x{0800}-\x{0815}\x{081a}\x{0824}\x{0828}\x{0840}-\x{0858}\x{08a0}\x{08a2}-\x{08ac}\x{0904}-\x{0939}\x{093d}\x{0950}\x{0958}-\x{0961}\x{0971}-\x{0977}\x{0979}-\x{097f}\x{0985}-\x{098c}\x{098f}\x{0990}\x{0993}-\x{09a8}\x{09aa}-\x{09b0}\x{09b2}\x{09b6}-\x{09b9}\x{09bd}\x{09ce}\x{09dc}\x{09dd}\x{09df}-\x{09e1}\x{09f0}\x{09f1}\x{0a05}-\x{0a0a}\x{0a0f}\x{0a10}\x{0a13}-\x{0a28}\x{0a2a}-\x{0a30}\x{0a32}\x{0a33}\x{0a35}\x{0a36}\x{0a38}\x{0a39}\x{0a59}-\x{0a5c}\x{0a5e}\x{0a72}-\x{0a74}\x{0a85}-\x{0a8d}\x{0a8f}-\x{0a91}\x{0a93}-\x{0aa8}\x{0aaa}-\x{0ab0}\x{0ab2}\x{0ab3}\x{0ab5}-\x{0ab9}\x{0abd}\x{0ad0}\x{0ae0}\x{0ae1}\x{0b05}-\x{0b0c}\x{0b0f}\x{0b10}\x{0b13}-\x{0b28}\x{0b2a}-\x{0b30}\x{0b32}\x{0b33}\x{0b35}-\x{0b39}\x{0b3d}\x{0b5c}\x{0b5d}\x{0b5f}-\x{0b61}\x{0b71}\x{0b83}\x{0b85}-\x{0b8a}\x{0b8e}-\x{0b90}\x{0b92}-\x{0b95}\x{0b99}\x{0b9a}\x{0b9c}\x{0b9e}\x{0b9f}\x{0ba3}\x{0ba4}\x{0ba8}-\x{0baa}\x{0bae}-\x{0bb9}\x{0bd0}\x{0c05}-\x{0c0c}\x{0c0e}-\x{0c10}\x{0c12}-\x{0c28}\x{0c2a}-\x{0c33}\x{0c35}-\x{0c39}\x{0c3d}\x{0c58}\x{0c59}\x{0c60}\x{0c61}\x{0c85}-\x{0c8c}\x{0c8e}-\x{0c90}\x{0c92}-\x{0ca8}\x{0caa}-\x{0cb3}\x{0cb5}-\x{0cb9}\x{0cbd}\x{0cde}\x{0ce0}\x{0ce1}\x{0cf1}\x{0cf2}\x{0d05}-\x{0d0c}\x{0d0e}-\x{0d10}\x{0d12}-\x{0d3a}\x{0d3d}\x{0d4e}\x{0d60}\x{0d61}\x{0d7a}-\x{0d7f}\x{0d85}-\x{0d96}\x{0d9a}-\x{0db1}\x{0db3}-\x{0dbb}\x{0dbd}\x{0dc0}-\x{0dc6}\x{0e01}-\x{0e30}\x{0e32}\x{0e33}\x{0e40}-\x{0e46}\x{0e81}\x{0e82}\x{0e84}\x{0e87}\x{0e88}\x{0e8a}\x{0e8d}\x{0e94}-\x{0e97}\x{0e99}-\x{0e9f}\x{0ea1}-\x{0ea3}\x{0ea5}\x{0ea7}\x{0eaa}\x{0eab}\x{0ead}-\x{0eb0}\x{0eb2}\x{0eb3}\x{0ebd}\x{0ec0}-\x{0ec4}\x{0ec6}\x{0edc}-\x{0edf}\x{0f00}\x{0f40}-\x{0f47}\x{0f49}-\x{0f6c}\x{0f88}-\x{0f8c}\x{1000}-\x{102a}\x{103f}\x{1050}-\x{1055}\x{105a}-\x{105d}\x{1061}\x{1065}\x{1066}\x{106e}-\x{1070}\x{1075}-\x{1081}\x{108e}\x{10a0}-\x{10c5}\x{10c7}\x{10cd}\x{10d0}-\x{10fa}\x{10fc}-\x{1248}\x{124a}-\x{124d}\x{1250}-\x{1256}\x{1258}\x{125a}-\x{125d}\x{1260}-\x{1288}\x{128a}-\x{128d}\x{1290}-\x{12b0}\x{12b2}-\x{12b5}\x{12b8}-\x{12be}\x{12c0}\x{12c2}-\x{12c5}\x{12c8}-\x{12d6}\x{12d8}-\x{1310}\x{1312}-\x{1315}\x{1318}-\x{135a}\x{1380}-\x{138f}\x{13a0}-\x{13f4}\x{1401}-\x{166c}\x{166f}-\x{167f}\x{1681}-\x{169a}\x{16a0}-\x{16ea}\x{16ee}-\x{16f0}\x{1700}-\x{170c}\x{170e}-\x{1711}\x{1720}-\x{1731}\x{1740}-\x{1751}\x{1760}-\x{176c}\x{176e}-\x{1770}\x{1780}-\x{17b3}\x{17d7}\x{17dc}\x{1820}-\x{1877}\x{1880}-\x{18a8}\x{18aa}\x{18b0}-\x{18f5}\x{1900}-\x{191c}\x{1950}-\x{196d}\x{1970}-\x{1974}\x{1980}-\x{19ab}\x{19c1}-\x{19c7}\x{1a00}-\x{1a16}\x{1a20}-\x{1a54}\x{1aa7}\x{1b05}-\x{1b33}\x{1b45}-\x{1b4b}\x{1b83}-\x{1ba0}\x{1bae}\x{1baf}\x{1bba}-\x{1be5}\x{1c00}-\x{1c23}\x{1c4d}-\x{1c4f}\x{1c5a}-\x{1c7d}\x{1ce9}-\x{1cec}\x{1cee}-\x{1cf1}\x{1cf5}\x{1cf6}\x{1d00}-\x{1dbf}\x{1e00}-\x{1f15}\x{1f18}-\x{1f1d}\x{1f20}-\x{1f45}\x{1f48}-\x{1f4d}\x{1f50}-\x{1f57}\x{1f59}\x{1f5b}\x{1f5d}\x{1f5f}-\x{1f7d}\x{1f80}-\x{1fb4}\x{1fb6}-\x{1fbc}\x{1fbe}\x{1fc2}-\x{1fc4}\x{1fc6}-\x{1fcc}\x{1fd0}-\x{1fd3}\x{1fd6}-\x{1fdb}\x{1fe0}-\x{1fec}\x{1ff2}-\x{1ff4}\x{1ff6}-\x{1ffc}\x{2071}\x{207f}\x{2090}-\x{209c}\x{2102}\x{2107}\x{210a}-\x{2113}\x{2115}\x{2119}-\x{211d}\x{2124}\x{2126}\x{2128}\x{212a}-\x{212d}\x{212f}-\x{2139}\x{213c}-\x{213f}\x{2145}-\x{2149}\x{214e}\x{2160}-\x{2188}\x{2c00}-\x{2c2e}\x{2c30}-\x{2c5e}\x{2c60}-\x{2ce4}\x{2ceb}-\x{2cee}\x{2cf2}\x{2cf3}\x{2d00}-\x{2d25}\x{2d27}\x{2d2d}\x{2d30}-\x{2d67}\x{2d6f}\x{2d80}-\x{2d96}\x{2da0}-\x{2da6}\x{2da8}-\x{2dae}\x{2db0}-\x{2db6}\x{2db8}-\x{2dbe}\x{2dc0}-\x{2dc6}\x{2dc8}-\x{2dce}\x{2dd0}-\x{2dd6}\x{2dd8}-\x{2dde}\x{2e2f}\x{3005}-\x{3007}\x{3021}-\x{3029}\x{3031}-\x{3035}\x{3038}-\x{303c}\x{3041}-\x{3096}\x{309d}-\x{309f}\x{30a1}-\x{30fa}\x{30fc}-\x{30ff}\x{3105}-\x{312d}\x{3131}-\x{318e}\x{31a0}-\x{31ba}\x{31f0}-\x{31ff}\x{3400}-\x{4db5}\x{4e00}-\x{9fcc}\x{a000}-\x{a48c}\x{a4d0}-\x{a4fd}\x{a500}-\x{a60c}\x{a610}-\x{a61f}\x{a62a}\x{a62b}\x{a640}-\x{a66e}\x{a67f}-\x{a697}\x{a6a0}-\x{a6ef}\x{a717}-\x{a71f}\x{a722}-\x{a788}\x{a78b}-\x{a78e}\x{a790}-\x{a793}\x{a7a0}-\x{a7aa}\x{a7f8}-\x{a801}\x{a803}-\x{a805}\x{a807}-\x{a80a}\x{a80c}-\x{a822}\x{a840}-\x{a873}\x{a882}-\x{a8b3}\x{a8f2}-\x{a8f7}\x{a8fb}\x{a90a}-\x{a925}\x{a930}-\x{a946}\x{a960}-\x{a97c}\x{a984}-\x{a9b2}\x{a9cf}\x{aa00}-\x{aa28}\x{aa40}-\x{aa42}\x{aa44}-\x{aa4b}\x{aa60}-\x{aa76}\x{aa7a}\x{aa80}-\x{aaaf}\x{aab1}\x{aab5}\x{aab6}\x{aab9}-\x{aabd}\x{aac0}\x{aac2}\x{aadb}-\x{aadd}\x{aae0}-\x{aaea}\x{aaf2}-\x{aaf4}\x{ab01}-\x{ab06}\x{ab09}-\x{ab0e}\x{ab11}-\x{ab16}\x{ab20}-\x{ab26}\x{ab28}-\x{ab2e}\x{abc0}-\x{abe2}\x{ac00}-\x{d7a3}\x{d7b0}-\x{d7c6}\x{d7cb}-\x{d7fb}\x{f900}-\x{fa6d}\x{fa70}-\x{fad9}\x{fb00}-\x{fb06}\x{fb13}-\x{fb17}\x{fb1d}\x{fb1f}-\x{fb28}\x{fb2a}-\x{fb36}\x{fb38}-\x{fb3c}\x{fb3e}\x{fb40}\x{fb41}\x{fb43}\x{fb44}\x{fb46}-\x{fbb1}\x{fbd3}-\x{fd3d}\x{fd50}-\x{fd8f}\x{fd92}-\x{fdc7}\x{fdf0}-\x{fdfb}\x{fe70}-\x{fe74}\x{fe76}-\x{fefc}\x{ff21}-\x{ff3a}\x{ff41}-\x{ff5a}\x{ff66}-\x{ffbe}\x{ffc2}-\x{ffc7}\x{ffca}-\x{ffcf}\x{ffd2}-\x{ffd7}\x{ffda}-\x{ffdc}][$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\x{02c1}\x{02c6}-\x{02d1}\x{02e0}-\x{02e4}\x{02ec}\x{02ee}\x{0370}-\x{0374}\x{0376}\x{0377}\x{037a}-\x{037d}\x{0386}\x{0388}-\x{038a}\x{038c}\x{038e}-\x{03a1}\x{03a3}-\x{03f5}\x{03f7}-\x{0481}\x{048a}-\x{0527}\x{0531}-\x{0556}\x{0559}\x{0561}-\x{0587}\x{05d0}-\x{05ea}\x{05f0}-\x{05f2}\x{0620}-\x{064a}\x{066e}\x{066f}\x{0671}-\x{06d3}\x{06d5}\x{06e5}\x{06e6}\x{06ee}\x{06ef}\x{06fa}-\x{06fc}\x{06ff}\x{0710}\x{0712}-\x{072f}\x{074d}-\x{07a5}\x{07b1}\x{07ca}-\x{07ea}\x{07f4}\x{07f5}\x{07fa}\x{0800}-\x{0815}\x{081a}\x{0824}\x{0828}\x{0840}-\x{0858}\x{08a0}\x{08a2}-\x{08ac}\x{0904}-\x{0939}\x{093d}\x{0950}\x{0958}-\x{0961}\x{0971}-\x{0977}\x{0979}-\x{097f}\x{0985}-\x{098c}\x{098f}\x{0990}\x{0993}-\x{09a8}\x{09aa}-\x{09b0}\x{09b2}\x{09b6}-\x{09b9}\x{09bd}\x{09ce}\x{09dc}\x{09dd}\x{09df}-\x{09e1}\x{09f0}\x{09f1}\x{0a05}-\x{0a0a}\x{0a0f}\x{0a10}\x{0a13}-\x{0a28}\x{0a2a}-\x{0a30}\x{0a32}\x{0a33}\x{0a35}\x{0a36}\x{0a38}\x{0a39}\x{0a59}-\x{0a5c}\x{0a5e}\x{0a72}-\x{0a74}\x{0a85}-\x{0a8d}\x{0a8f}-\x{0a91}\x{0a93}-\x{0aa8}\x{0aaa}-\x{0ab0}\x{0ab2}\x{0ab3}\x{0ab5}-\x{0ab9}\x{0abd}\x{0ad0}\x{0ae0}\x{0ae1}\x{0b05}-\x{0b0c}\x{0b0f}\x{0b10}\x{0b13}-\x{0b28}\x{0b2a}-\x{0b30}\x{0b32}\x{0b33}\x{0b35}-\x{0b39}\x{0b3d}\x{0b5c}\x{0b5d}\x{0b5f}-\x{0b61}\x{0b71}\x{0b83}\x{0b85}-\x{0b8a}\x{0b8e}-\x{0b90}\x{0b92}-\x{0b95}\x{0b99}\x{0b9a}\x{0b9c}\x{0b9e}\x{0b9f}\x{0ba3}\x{0ba4}\x{0ba8}-\x{0baa}\x{0bae}-\x{0bb9}\x{0bd0}\x{0c05}-\x{0c0c}\x{0c0e}-\x{0c10}\x{0c12}-\x{0c28}\x{0c2a}-\x{0c33}\x{0c35}-\x{0c39}\x{0c3d}\x{0c58}\x{0c59}\x{0c60}\x{0c61}\x{0c85}-\x{0c8c}\x{0c8e}-\x{0c90}\x{0c92}-\x{0ca8}\x{0caa}-\x{0cb3}\x{0cb5}-\x{0cb9}\x{0cbd}\x{0cde}\x{0ce0}\x{0ce1}\x{0cf1}\x{0cf2}\x{0d05}-\x{0d0c}\x{0d0e}-\x{0d10}\x{0d12}-\x{0d3a}\x{0d3d}\x{0d4e}\x{0d60}\x{0d61}\x{0d7a}-\x{0d7f}\x{0d85}-\x{0d96}\x{0d9a}-\x{0db1}\x{0db3}-\x{0dbb}\x{0dbd}\x{0dc0}-\x{0dc6}\x{0e01}-\x{0e30}\x{0e32}\x{0e33}\x{0e40}-\x{0e46}\x{0e81}\x{0e82}\x{0e84}\x{0e87}\x{0e88}\x{0e8a}\x{0e8d}\x{0e94}-\x{0e97}\x{0e99}-\x{0e9f}\x{0ea1}-\x{0ea3}\x{0ea5}\x{0ea7}\x{0eaa}\x{0eab}\x{0ead}-\x{0eb0}\x{0eb2}\x{0eb3}\x{0ebd}\x{0ec0}-\x{0ec4}\x{0ec6}\x{0edc}-\x{0edf}\x{0f00}\x{0f40}-\x{0f47}\x{0f49}-\x{0f6c}\x{0f88}-\x{0f8c}\x{1000}-\x{102a}\x{103f}\x{1050}-\x{1055}\x{105a}-\x{105d}\x{1061}\x{1065}\x{1066}\x{106e}-\x{1070}\x{1075}-\x{1081}\x{108e}\x{10a0}-\x{10c5}\x{10c7}\x{10cd}\x{10d0}-\x{10fa}\x{10fc}-\x{1248}\x{124a}-\x{124d}\x{1250}-\x{1256}\x{1258}\x{125a}-\x{125d}\x{1260}-\x{1288}\x{128a}-\x{128d}\x{1290}-\x{12b0}\x{12b2}-\x{12b5}\x{12b8}-\x{12be}\x{12c0}\x{12c2}-\x{12c5}\x{12c8}-\x{12d6}\x{12d8}-\x{1310}\x{1312}-\x{1315}\x{1318}-\x{135a}\x{1380}-\x{138f}\x{13a0}-\x{13f4}\x{1401}-\x{166c}\x{166f}-\x{167f}\x{1681}-\x{169a}\x{16a0}-\x{16ea}\x{16ee}-\x{16f0}\x{1700}-\x{170c}\x{170e}-\x{1711}\x{1720}-\x{1731}\x{1740}-\x{1751}\x{1760}-\x{176c}\x{176e}-\x{1770}\x{1780}-\x{17b3}\x{17d7}\x{17dc}\x{1820}-\x{1877}\x{1880}-\x{18a8}\x{18aa}\x{18b0}-\x{18f5}\x{1900}-\x{191c}\x{1950}-\x{196d}\x{1970}-\x{1974}\x{1980}-\x{19ab}\x{19c1}-\x{19c7}\x{1a00}-\x{1a16}\x{1a20}-\x{1a54}\x{1aa7}\x{1b05}-\x{1b33}\x{1b45}-\x{1b4b}\x{1b83}-\x{1ba0}\x{1bae}\x{1baf}\x{1bba}-\x{1be5}\x{1c00}-\x{1c23}\x{1c4d}-\x{1c4f}\x{1c5a}-\x{1c7d}\x{1ce9}-\x{1cec}\x{1cee}-\x{1cf1}\x{1cf5}\x{1cf6}\x{1d00}-\x{1dbf}\x{1e00}-\x{1f15}\x{1f18}-\x{1f1d}\x{1f20}-\x{1f45}\x{1f48}-\x{1f4d}\x{1f50}-\x{1f57}\x{1f59}\x{1f5b}\x{1f5d}\x{1f5f}-\x{1f7d}\x{1f80}-\x{1fb4}\x{1fb6}-\x{1fbc}\x{1fbe}\x{1fc2}-\x{1fc4}\x{1fc6}-\x{1fcc}\x{1fd0}-\x{1fd3}\x{1fd6}-\x{1fdb}\x{1fe0}-\x{1fec}\x{1ff2}-\x{1ff4}\x{1ff6}-\x{1ffc}\x{2071}\x{207f}\x{2090}-\x{209c}\x{2102}\x{2107}\x{210a}-\x{2113}\x{2115}\x{2119}-\x{211d}\x{2124}\x{2126}\x{2128}\x{212a}-\x{212d}\x{212f}-\x{2139}\x{213c}-\x{213f}\x{2145}-\x{2149}\x{214e}\x{2160}-\x{2188}\x{2c00}-\x{2c2e}\x{2c30}-\x{2c5e}\x{2c60}-\x{2ce4}\x{2ceb}-\x{2cee}\x{2cf2}\x{2cf3}\x{2d00}-\x{2d25}\x{2d27}\x{2d2d}\x{2d30}-\x{2d67}\x{2d6f}\x{2d80}-\x{2d96}\x{2da0}-\x{2da6}\x{2da8}-\x{2dae}\x{2db0}-\x{2db6}\x{2db8}-\x{2dbe}\x{2dc0}-\x{2dc6}\x{2dc8}-\x{2dce}\x{2dd0}-\x{2dd6}\x{2dd8}-\x{2dde}\x{2e2f}\x{3005}-\x{3007}\x{3021}-\x{3029}\x{3031}-\x{3035}\x{3038}-\x{303c}\x{3041}-\x{3096}\x{309d}-\x{309f}\x{30a1}-\x{30fa}\x{30fc}-\x{30ff}\x{3105}-\x{312d}\x{3131}-\x{318e}\x{31a0}-\x{31ba}\x{31f0}-\x{31ff}\x{3400}-\x{4db5}\x{4e00}-\x{9fcc}\x{a000}-\x{a48c}\x{a4d0}-\x{a4fd}\x{a500}-\x{a60c}\x{a610}-\x{a61f}\x{a62a}\x{a62b}\x{a640}-\x{a66e}\x{a67f}-\x{a697}\x{a6a0}-\x{a6ef}\x{a717}-\x{a71f}\x{a722}-\x{a788}\x{a78b}-\x{a78e}\x{a790}-\x{a793}\x{a7a0}-\x{a7aa}\x{a7f8}-\x{a801}\x{a803}-\x{a805}\x{a807}-\x{a80a}\x{a80c}-\x{a822}\x{a840}-\x{a873}\x{a882}-\x{a8b3}\x{a8f2}-\x{a8f7}\x{a8fb}\x{a90a}-\x{a925}\x{a930}-\x{a946}\x{a960}-\x{a97c}\x{a984}-\x{a9b2}\x{a9cf}\x{aa00}-\x{aa28}\x{aa40}-\x{aa42}\x{aa44}-\x{aa4b}\x{aa60}-\x{aa76}\x{aa7a}\x{aa80}-\x{aaaf}\x{aab1}\x{aab5}\x{aab6}\x{aab9}-\x{aabd}\x{aac0}\x{aac2}\x{aadb}-\x{aadd}\x{aae0}-\x{aaea}\x{aaf2}-\x{aaf4}\x{ab01}-\x{ab06}\x{ab09}-\x{ab0e}\x{ab11}-\x{ab16}\x{ab20}-\x{ab26}\x{ab28}-\x{ab2e}\x{abc0}-\x{abe2}\x{ac00}-\x{d7a3}\x{d7b0}-\x{d7c6}\x{d7cb}-\x{d7fb}\x{f900}-\x{fa6d}\x{fa70}-\x{fad9}\x{fb00}-\x{fb06}\x{fb13}-\x{fb17}\x{fb1d}\x{fb1f}-\x{fb28}\x{fb2a}-\x{fb36}\x{fb38}-\x{fb3c}\x{fb3e}\x{fb40}\x{fb41}\x{fb43}\x{fb44}\x{fb46}-\x{fbb1}\x{fbd3}-\x{fd3d}\x{fd50}-\x{fd8f}\x{fd92}-\x{fdc7}\x{fdf0}-\x{fdfb}\x{fe70}-\x{fe74}\x{fe76}-\x{fefc}\x{ff21}-\x{ff3a}\x{ff41}-\x{ff5a}\x{ff66}-\x{ffbe}\x{ffc2}-\x{ffc7}\x{ffca}-\x{ffcf}\x{ffd2}-\x{ffd7}\x{ffda}-\x{ffdc}0-9\x{0300}-\x{036f}\x{0483}-\x{0487}\x{0591}-\x{05bd}\x{05bf}\x{05c1}\x{05c2}\x{05c4}\x{05c5}\x{05c7}\x{0610}-\x{061a}\x{064b}-\x{0669}\x{0670}\x{06d6}-\x{06dc}\x{06df}-\x{06e4}\x{06e7}\x{06e8}\x{06ea}-\x{06ed}\x{06f0}-\x{06f9}\x{0711}\x{0730}-\x{074a}\x{07a6}-\x{07b0}\x{07c0}-\x{07c9}\x{07eb}-\x{07f3}\x{0816}-\x{0819}\x{081b}-\x{0823}\x{0825}-\x{0827}\x{0829}-\x{082d}\x{0859}-\x{085b}\x{08e4}-\x{08fe}\x{0900}-\x{0903}\x{093a}-\x{093c}\x{093e}-\x{094f}\x{0951}-\x{0957}\x{0962}\x{0963}\x{0966}-\x{096f}\x{0981}-\x{0983}\x{09bc}\x{09be}-\x{09c4}\x{09c7}\x{09c8}\x{09cb}-\x{09cd}\x{09d7}\x{09e2}\x{09e3}\x{09e6}-\x{09ef}\x{0a01}-\x{0a03}\x{0a3c}\x{0a3e}-\x{0a42}\x{0a47}\x{0a48}\x{0a4b}-\x{0a4d}\x{0a51}\x{0a66}-\x{0a71}\x{0a75}\x{0a81}-\x{0a83}\x{0abc}\x{0abe}-\x{0ac5}\x{0ac7}-\x{0ac9}\x{0acb}-\x{0acd}\x{0ae2}\x{0ae3}\x{0ae6}-\x{0aef}\x{0b01}-\x{0b03}\x{0b3c}\x{0b3e}-\x{0b44}\x{0b47}\x{0b48}\x{0b4b}-\x{0b4d}\x{0b56}\x{0b57}\x{0b62}\x{0b63}\x{0b66}-\x{0b6f}\x{0b82}\x{0bbe}-\x{0bc2}\x{0bc6}-\x{0bc8}\x{0bca}-\x{0bcd}\x{0bd7}\x{0be6}-\x{0bef}\x{0c01}-\x{0c03}\x{0c3e}-\x{0c44}\x{0c46}-\x{0c48}\x{0c4a}-\x{0c4d}\x{0c55}\x{0c56}\x{0c62}\x{0c63}\x{0c66}-\x{0c6f}\x{0c82}\x{0c83}\x{0cbc}\x{0cbe}-\x{0cc4}\x{0cc6}-\x{0cc8}\x{0cca}-\x{0ccd}\x{0cd5}\x{0cd6}\x{0ce2}\x{0ce3}\x{0ce6}-\x{0cef}\x{0d02}\x{0d03}\x{0d3e}-\x{0d44}\x{0d46}-\x{0d48}\x{0d4a}-\x{0d4d}\x{0d57}\x{0d62}\x{0d63}\x{0d66}-\x{0d6f}\x{0d82}\x{0d83}\x{0dca}\x{0dcf}-\x{0dd4}\x{0dd6}\x{0dd8}-\x{0ddf}\x{0df2}\x{0df3}\x{0e31}\x{0e34}-\x{0e3a}\x{0e47}-\x{0e4e}\x{0e50}-\x{0e59}\x{0eb1}\x{0eb4}-\x{0eb9}\x{0ebb}\x{0ebc}\x{0ec8}-\x{0ecd}\x{0ed0}-\x{0ed9}\x{0f18}\x{0f19}\x{0f20}-\x{0f29}\x{0f35}\x{0f37}\x{0f39}\x{0f3e}\x{0f3f}\x{0f71}-\x{0f84}\x{0f86}\x{0f87}\x{0f8d}-\x{0f97}\x{0f99}-\x{0fbc}\x{0fc6}\x{102b}-\x{103e}\x{1040}-\x{1049}\x{1056}-\x{1059}\x{105e}-\x{1060}\x{1062}-\x{1064}\x{1067}-\x{106d}\x{1071}-\x{1074}\x{1082}-\x{108d}\x{108f}-\x{109d}\x{135d}-\x{135f}\x{1712}-\x{1714}\x{1732}-\x{1734}\x{1752}\x{1753}\x{1772}\x{1773}\x{17b4}-\x{17d3}\x{17dd}\x{17e0}-\x{17e9}\x{180b}-\x{180d}\x{1810}-\x{1819}\x{18a9}\x{1920}-\x{192b}\x{1930}-\x{193b}\x{1946}-\x{194f}\x{19b0}-\x{19c0}\x{19c8}\x{19c9}\x{19d0}-\x{19d9}\x{1a17}-\x{1a1b}\x{1a55}-\x{1a5e}\x{1a60}-\x{1a7c}\x{1a7f}-\x{1a89}\x{1a90}-\x{1a99}\x{1b00}-\x{1b04}\x{1b34}-\x{1b44}\x{1b50}-\x{1b59}\x{1b6b}-\x{1b73}\x{1b80}-\x{1b82}\x{1ba1}-\x{1bad}\x{1bb0}-\x{1bb9}\x{1be6}-\x{1bf3}\x{1c24}-\x{1c37}\x{1c40}-\x{1c49}\x{1c50}-\x{1c59}\x{1cd0}-\x{1cd2}\x{1cd4}-\x{1ce8}\x{1ced}\x{1cf2}-\x{1cf4}\x{1dc0}-\x{1de6}\x{1dfc}-\x{1dff}\x{200c}\x{200d}\x{203f}\x{2040}\x{2054}\x{20d0}-\x{20dc}\x{20e1}\x{20e5}-\x{20f0}\x{2cef}-\x{2cf1}\x{2d7f}\x{2de0}-\x{2dff}\x{302a}-\x{302f}\x{3099}\x{309a}\x{a620}-\x{a629}\x{a66f}\x{a674}-\x{a67d}\x{a69f}\x{a6f0}\x{a6f1}\x{a802}\x{a806}\x{a80b}\x{a823}-\x{a827}\x{a880}\x{a881}\x{a8b4}-\x{a8c4}\x{a8d0}-\x{a8d9}\x{a8e0}-\x{a8f1}\x{a900}-\x{a909}\x{a926}-\x{a92d}\x{a947}-\x{a953}\x{a980}-\x{a983}\x{a9b3}-\x{a9c0}\x{a9d0}-\x{a9d9}\x{aa29}-\x{aa36}\x{aa43}\x{aa4c}\x{aa4d}\x{aa50}-\x{aa59}\x{aa7b}\x{aab0}\x{aab2}-\x{aab4}\x{aab7}\x{aab8}\x{aabe}\x{aabf}\x{aac1}\x{aaeb}-\x{aaef}\x{aaf5}\x{aaf6}\x{abe3}-\x{abea}\x{abec}\x{abed}\x{abf0}-\x{abf9}\x{fb1e}\x{fe00}-\x{fe0f}\x{fe20}-\x{fe26}\x{fe33}\x{fe34}\x{fe4d}-\x{fe4f}\x{ff10}-\x{ff19}\x{ff3f}]*\b'</span>;
</span><span id="26" class="l"><a href="#26"> 26: </a>
</span><span id="27" class="l"><a href="#27"> 27: </a>    <span class="php-comment">/**
</span></span><span id="28" class="l"><a href="#28"> 28: </a><span class="php-comment">     * Full list of JavaScript reserved words.
</span></span><span id="29" class="l"><a href="#29"> 29: </a><span class="php-comment">     * Will be loaded from /data/js/keywords_reserved.txt.
</span></span><span id="30" class="l"><a href="#30"> 30: </a><span class="php-comment">     *
</span></span><span id="31" class="l"><a href="#31"> 31: </a><span class="php-comment">     * @see https://mathiasbynens.be/notes/reserved-keywords
</span></span><span id="32" class="l"><a href="#32"> 32: </a><span class="php-comment">     *
</span></span><span id="33" class="l"><a href="#33"> 33: </a><span class="php-comment">     * @var string[]
</span></span><span id="34" class="l"><a href="#34"> 34: </a><span class="php-comment">     */</span>
</span><span id="35" class="l"><a href="#35"> 35: </a>    <span class="php-keyword1">protected</span> <span class="php-var">$keywordsReserved</span> = <span class="php-keyword1">array</span>();
</span><span id="36" class="l"><a href="#36"> 36: </a>
</span><span id="37" class="l"><a href="#37"> 37: </a>    <span class="php-comment">/**
</span></span><span id="38" class="l"><a href="#38"> 38: </a><span class="php-comment">     * List of JavaScript reserved words that accept a &lt;variable, value, ...&gt;
</span></span><span id="39" class="l"><a href="#39"> 39: </a><span class="php-comment">     * after them. Some end of lines are not the end of a statement, like with
</span></span><span id="40" class="l"><a href="#40"> 40: </a><span class="php-comment">     * these keywords.
</span></span><span id="41" class="l"><a href="#41"> 41: </a><span class="php-comment">     *
</span></span><span id="42" class="l"><a href="#42"> 42: </a><span class="php-comment">     * E.g.: we shouldn't insert a ; after this else
</span></span><span id="43" class="l"><a href="#43"> 43: </a><span class="php-comment">     * else
</span></span><span id="44" class="l"><a href="#44"> 44: </a><span class="php-comment">     *     console.log('this is quite fine')
</span></span><span id="45" class="l"><a href="#45"> 45: </a><span class="php-comment">     *
</span></span><span id="46" class="l"><a href="#46"> 46: </a><span class="php-comment">     * Will be loaded from /data/js/keywords_before.txt
</span></span><span id="47" class="l"><a href="#47"> 47: </a><span class="php-comment">     *
</span></span><span id="48" class="l"><a href="#48"> 48: </a><span class="php-comment">     * @var string[]
</span></span><span id="49" class="l"><a href="#49"> 49: </a><span class="php-comment">     */</span>
</span><span id="50" class="l"><a href="#50"> 50: </a>    <span class="php-keyword1">protected</span> <span class="php-var">$keywordsBefore</span> = <span class="php-keyword1">array</span>();
</span><span id="51" class="l"><a href="#51"> 51: </a>
</span><span id="52" class="l"><a href="#52"> 52: </a>    <span class="php-comment">/**
</span></span><span id="53" class="l"><a href="#53"> 53: </a><span class="php-comment">     * List of JavaScript reserved words that accept a &lt;variable, value, ...&gt;
</span></span><span id="54" class="l"><a href="#54"> 54: </a><span class="php-comment">     * before them. Some end of lines are not the end of a statement, like when
</span></span><span id="55" class="l"><a href="#55"> 55: </a><span class="php-comment">     * continued by one of these keywords on the newline.
</span></span><span id="56" class="l"><a href="#56"> 56: </a><span class="php-comment">     *
</span></span><span id="57" class="l"><a href="#57"> 57: </a><span class="php-comment">     * E.g.: we shouldn't insert a ; before this instanceof
</span></span><span id="58" class="l"><a href="#58"> 58: </a><span class="php-comment">     * variable
</span></span><span id="59" class="l"><a href="#59"> 59: </a><span class="php-comment">     *     instanceof String
</span></span><span id="60" class="l"><a href="#60"> 60: </a><span class="php-comment">     *
</span></span><span id="61" class="l"><a href="#61"> 61: </a><span class="php-comment">     * Will be loaded from /data/js/keywords_after.txt
</span></span><span id="62" class="l"><a href="#62"> 62: </a><span class="php-comment">     *
</span></span><span id="63" class="l"><a href="#63"> 63: </a><span class="php-comment">     * @var string[]
</span></span><span id="64" class="l"><a href="#64"> 64: </a><span class="php-comment">     */</span>
</span><span id="65" class="l"><a href="#65"> 65: </a>    <span class="php-keyword1">protected</span> <span class="php-var">$keywordsAfter</span> = <span class="php-keyword1">array</span>();
</span><span id="66" class="l"><a href="#66"> 66: </a>
</span><span id="67" class="l"><a href="#67"> 67: </a>    <span class="php-comment">/**
</span></span><span id="68" class="l"><a href="#68"> 68: </a><span class="php-comment">     * List of JavaScript operators that accept a &lt;variable, value, ...&gt; after
</span></span><span id="69" class="l"><a href="#69"> 69: </a><span class="php-comment">     * them. Some end of lines are not the end of a statement, like with these
</span></span><span id="70" class="l"><a href="#70"> 70: </a><span class="php-comment">     * operators.
</span></span><span id="71" class="l"><a href="#71"> 71: </a><span class="php-comment">     *
</span></span><span id="72" class="l"><a href="#72"> 72: </a><span class="php-comment">     * Note: Most operators are fine, we've only removed !, ++ and --.
</span></span><span id="73" class="l"><a href="#73"> 73: </a><span class="php-comment">     * There can't be a newline separating ! and whatever it is negating.
</span></span><span id="74" class="l"><a href="#74"> 74: </a><span class="php-comment">     * ++ &amp; -- have to be joined with the value they're in-/decrementing.
</span></span><span id="75" class="l"><a href="#75"> 75: </a><span class="php-comment">     *
</span></span><span id="76" class="l"><a href="#76"> 76: </a><span class="php-comment">     * Will be loaded from /data/js/operators_before.txt
</span></span><span id="77" class="l"><a href="#77"> 77: </a><span class="php-comment">     *
</span></span><span id="78" class="l"><a href="#78"> 78: </a><span class="php-comment">     * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators
</span></span><span id="79" class="l"><a href="#79"> 79: </a><span class="php-comment">     *
</span></span><span id="80" class="l"><a href="#80"> 80: </a><span class="php-comment">     * @var string[]
</span></span><span id="81" class="l"><a href="#81"> 81: </a><span class="php-comment">     */</span>
</span><span id="82" class="l"><a href="#82"> 82: </a>    <span class="php-keyword1">protected</span> <span class="php-var">$operatorsBefore</span> = <span class="php-keyword1">array</span>();
</span><span id="83" class="l"><a href="#83"> 83: </a>
</span><span id="84" class="l"><a href="#84"> 84: </a>    <span class="php-comment">/**
</span></span><span id="85" class="l"><a href="#85"> 85: </a><span class="php-comment">     * List of JavaScript operators that accept a &lt;variable, value, ...&gt; before
</span></span><span id="86" class="l"><a href="#86"> 86: </a><span class="php-comment">     * them. Some end of lines are not the end of a statement, like when
</span></span><span id="87" class="l"><a href="#87"> 87: </a><span class="php-comment">     * continued by one of these operators on the newline.
</span></span><span id="88" class="l"><a href="#88"> 88: </a><span class="php-comment">     *
</span></span><span id="89" class="l"><a href="#89"> 89: </a><span class="php-comment">     * Note: Most operators are fine, we've only removed ), ], ++ and --.
</span></span><span id="90" class="l"><a href="#90"> 90: </a><span class="php-comment">     * ++ &amp; -- have to be joined with the value they're in-/decrementing.
</span></span><span id="91" class="l"><a href="#91"> 91: </a><span class="php-comment">     * ) &amp; ] are &quot;special&quot; in that they have lots or usecases. () for example
</span></span><span id="92" class="l"><a href="#92"> 92: </a><span class="php-comment">     * is used for function calls, for grouping, in if () and for (), ...
</span></span><span id="93" class="l"><a href="#93"> 93: </a><span class="php-comment">     *
</span></span><span id="94" class="l"><a href="#94"> 94: </a><span class="php-comment">     * Will be loaded from /data/js/operators_after.txt
</span></span><span id="95" class="l"><a href="#95"> 95: </a><span class="php-comment">     *
</span></span><span id="96" class="l"><a href="#96"> 96: </a><span class="php-comment">     * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators
</span></span><span id="97" class="l"><a href="#97"> 97: </a><span class="php-comment">     *
</span></span><span id="98" class="l"><a href="#98"> 98: </a><span class="php-comment">     * @var string[]
</span></span><span id="99" class="l"><a href="#99"> 99: </a><span class="php-comment">     */</span>
</span><span id="100" class="l"><a href="#100">100: </a>    <span class="php-keyword1">protected</span> <span class="php-var">$operatorsAfter</span> = <span class="php-keyword1">array</span>();
</span><span id="101" class="l"><a href="#101">101: </a>
</span><span id="102" class="l"><a href="#102">102: </a>    <span class="php-comment">/**
</span></span><span id="103" class="l"><a href="#103">103: </a><span class="php-comment">     * {@inheritdoc}
</span></span><span id="104" class="l"><a href="#104">104: </a><span class="php-comment">     */</span>
</span><span id="105" class="l"><a href="#105">105: </a>    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> __construct()
</span><span id="106" class="l"><a href="#106">106: </a>    {
</span><span id="107" class="l"><a href="#107">107: </a>        <span class="php-keyword2">call_user_func_array</span>(<span class="php-keyword1">array</span>(<span class="php-quote">'parent'</span>, <span class="php-quote">'__construct'</span>), <span class="php-keyword2">func_get_args</span>());
</span><span id="108" class="l"><a href="#108">108: </a>
</span><span id="109" class="l"><a href="#109">109: </a>        <span class="php-var">$dataDir</span> = __DIR__.<span class="php-quote">'/../data/js/'</span>;
</span><span id="110" class="l"><a href="#110">110: </a>        <span class="php-var">$options</span> = FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES;
</span><span id="111" class="l"><a href="#111">111: </a>        <span class="php-var">$this</span>-&gt;keywordsReserved = <span class="php-keyword2">file</span>(<span class="php-var">$dataDir</span>.<span class="php-quote">'keywords_reserved.txt'</span>, <span class="php-var">$options</span>);
</span><span id="112" class="l"><a href="#112">112: </a>        <span class="php-var">$this</span>-&gt;keywordsBefore = <span class="php-keyword2">file</span>(<span class="php-var">$dataDir</span>.<span class="php-quote">'keywords_before.txt'</span>, <span class="php-var">$options</span>);
</span><span id="113" class="l"><a href="#113">113: </a>        <span class="php-var">$this</span>-&gt;keywordsAfter = <span class="php-keyword2">file</span>(<span class="php-var">$dataDir</span>.<span class="php-quote">'keywords_after.txt'</span>, <span class="php-var">$options</span>);
</span><span id="114" class="l"><a href="#114">114: </a>        <span class="php-var">$this</span>-&gt;operatorsBefore = <span class="php-keyword2">file</span>(<span class="php-var">$dataDir</span>.<span class="php-quote">'operators_before.txt'</span>, <span class="php-var">$options</span>);
</span><span id="115" class="l"><a href="#115">115: </a>        <span class="php-var">$this</span>-&gt;operatorsAfter = <span class="php-keyword2">file</span>(<span class="php-var">$dataDir</span>.<span class="php-quote">'operators_after.txt'</span>, <span class="php-var">$options</span>);
</span><span id="116" class="l"><a href="#116">116: </a>    }
</span><span id="117" class="l"><a href="#117">117: </a>
</span><span id="118" class="l"><a href="#118">118: </a>    <span class="php-comment">/**
</span></span><span id="119" class="l"><a href="#119">119: </a><span class="php-comment">     * Minify the data.
</span></span><span id="120" class="l"><a href="#120">120: </a><span class="php-comment">     * Perform JS optimizations.
</span></span><span id="121" class="l"><a href="#121">121: </a><span class="php-comment">     *
</span></span><span id="122" class="l"><a href="#122">122: </a><span class="php-comment">     * @param string[optional] $path Path to write the data to.
</span></span><span id="123" class="l"><a href="#123">123: </a><span class="php-comment">     *
</span></span><span id="124" class="l"><a href="#124">124: </a><span class="php-comment">     * @return string The minified data.
</span></span><span id="125" class="l"><a href="#125">125: </a><span class="php-comment">     */</span>
</span><span id="126" class="l"><a href="#126">126: </a>    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> execute(<span class="php-var">$path</span> = <span class="php-keyword1">null</span>)
</span><span id="127" class="l"><a href="#127">127: </a>    {
</span><span id="128" class="l"><a href="#128">128: </a>        <span class="php-var">$content</span> = <span class="php-quote">''</span>;
</span><span id="129" class="l"><a href="#129">129: </a>
</span><span id="130" class="l"><a href="#130">130: </a>        <span class="php-comment">// loop files</span>
</span><span id="131" class="l"><a href="#131">131: </a>        <span class="php-keyword1">foreach</span> (<span class="php-var">$this</span>-&gt;data <span class="php-keyword1">as</span> <span class="php-var">$source</span> =&gt; <span class="php-var">$js</span>) {
</span><span id="132" class="l"><a href="#132">132: </a>            <span class="php-comment">/*
</span></span><span id="133" class="l"><a href="#133">133: </a><span class="php-comment">             * Combine js: separating the scripts by a ;
</span></span><span id="134" class="l"><a href="#134">134: </a><span class="php-comment">             * I'm also adding a newline: it will be eaten when whitespace is
</span></span><span id="135" class="l"><a href="#135">135: </a><span class="php-comment">             * stripped, but we need to make sure we're not just appending
</span></span><span id="136" class="l"><a href="#136">136: </a><span class="php-comment">             * a new script right after a previous script that ended with a
</span></span><span id="137" class="l"><a href="#137">137: </a><span class="php-comment">             * singe-line comment on the last line (in which case it would also
</span></span><span id="138" class="l"><a href="#138">138: </a><span class="php-comment">             * be seen as part of that comment)
</span></span><span id="139" class="l"><a href="#139">139: </a><span class="php-comment">             */</span>
</span><span id="140" class="l"><a href="#140">140: </a>            <span class="php-var">$content</span> .= <span class="php-var">$js</span>.<span class="php-quote">&quot;\n;&quot;</span>;
</span><span id="141" class="l"><a href="#141">141: </a>        }
</span><span id="142" class="l"><a href="#142">142: </a>
</span><span id="143" class="l"><a href="#143">143: </a>        <span class="php-comment">/*
</span></span><span id="144" class="l"><a href="#144">144: </a><span class="php-comment">         * Let's first take out strings, comments and regular expressions.
</span></span><span id="145" class="l"><a href="#145">145: </a><span class="php-comment">         * All of these can contain JS code-like characters, and we should make
</span></span><span id="146" class="l"><a href="#146">146: </a><span class="php-comment">         * sure any further magic ignores anything inside of these.
</span></span><span id="147" class="l"><a href="#147">147: </a><span class="php-comment">         *
</span></span><span id="148" class="l"><a href="#148">148: </a><span class="php-comment">         * Consider this example, where we should not strip any whitespace:
</span></span><span id="149" class="l"><a href="#149">149: </a><span class="php-comment">         * var str = &quot;a   test&quot;;
</span></span><span id="150" class="l"><a href="#150">150: </a><span class="php-comment">         *
</span></span><span id="151" class="l"><a href="#151">151: </a><span class="php-comment">         * Comments will be removed altogether, strings and regular expressions
</span></span><span id="152" class="l"><a href="#152">152: </a><span class="php-comment">         * will be replaced by placeholder text, which we'll restore later.
</span></span><span id="153" class="l"><a href="#153">153: </a><span class="php-comment">         */</span>
</span><span id="154" class="l"><a href="#154">154: </a>        <span class="php-var">$this</span>-&gt;extractStrings(<span class="php-quote">'\'&quot;`'</span>);
</span><span id="155" class="l"><a href="#155">155: </a>        <span class="php-var">$this</span>-&gt;stripComments();
</span><span id="156" class="l"><a href="#156">156: </a>        <span class="php-var">$this</span>-&gt;extractRegex();
</span><span id="157" class="l"><a href="#157">157: </a>        <span class="php-var">$content</span> = <span class="php-var">$this</span>-&gt;replace(<span class="php-var">$content</span>);
</span><span id="158" class="l"><a href="#158">158: </a>
</span><span id="159" class="l"><a href="#159">159: </a>        <span class="php-var">$content</span> = <span class="php-var">$this</span>-&gt;stripWhitespace(<span class="php-var">$content</span>);
</span><span id="160" class="l"><a href="#160">160: </a>        <span class="php-var">$content</span> = <span class="php-var">$this</span>-&gt;propertyNotation(<span class="php-var">$content</span>);
</span><span id="161" class="l"><a href="#161">161: </a>        <span class="php-var">$content</span> = <span class="php-var">$this</span>-&gt;shortenBools(<span class="php-var">$content</span>);
</span><span id="162" class="l"><a href="#162">162: </a>
</span><span id="163" class="l"><a href="#163">163: </a>        <span class="php-comment">/*
</span></span><span id="164" class="l"><a href="#164">164: </a><span class="php-comment">         * Earlier, we extracted strings &amp; regular expressions and replaced them
</span></span><span id="165" class="l"><a href="#165">165: </a><span class="php-comment">         * with placeholder text. This will restore them.
</span></span><span id="166" class="l"><a href="#166">166: </a><span class="php-comment">         */</span>
</span><span id="167" class="l"><a href="#167">167: </a>        <span class="php-var">$content</span> = <span class="php-var">$this</span>-&gt;restoreExtractedData(<span class="php-var">$content</span>);
</span><span id="168" class="l"><a href="#168">168: </a>
</span><span id="169" class="l"><a href="#169">169: </a>        <span class="php-keyword1">return</span> <span class="php-var">$content</span>;
</span><span id="170" class="l"><a href="#170">170: </a>    }
</span><span id="171" class="l"><a href="#171">171: </a>
</span><span id="172" class="l"><a href="#172">172: </a>    <span class="php-comment">/**
</span></span><span id="173" class="l"><a href="#173">173: </a><span class="php-comment">     * Strip comments from source code.
</span></span><span id="174" class="l"><a href="#174">174: </a><span class="php-comment">     */</span>
</span><span id="175" class="l"><a href="#175">175: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> stripComments()
</span><span id="176" class="l"><a href="#176">176: </a>    {
</span><span id="177" class="l"><a href="#177">177: </a>        <span class="php-comment">// single-line comments</span>
</span><span id="178" class="l"><a href="#178">178: </a>        <span class="php-var">$this</span>-&gt;registerPattern(<span class="php-quote">'/\/\/.*$/m'</span>, <span class="php-quote">''</span>);
</span><span id="179" class="l"><a href="#179">179: </a>
</span><span id="180" class="l"><a href="#180">180: </a>        <span class="php-comment">// multi-line comments</span>
</span><span id="181" class="l"><a href="#181">181: </a>        <span class="php-var">$this</span>-&gt;registerPattern(<span class="php-quote">'/\/\*.*?\*\//s'</span>, <span class="php-quote">''</span>);
</span><span id="182" class="l"><a href="#182">182: </a>    }
</span><span id="183" class="l"><a href="#183">183: </a>
</span><span id="184" class="l"><a href="#184">184: </a>    <span class="php-comment">/**
</span></span><span id="185" class="l"><a href="#185">185: </a><span class="php-comment">     * JS can have /-delimited regular expressions, like: /ab+c/.match(string).
</span></span><span id="186" class="l"><a href="#186">186: </a><span class="php-comment">     *
</span></span><span id="187" class="l"><a href="#187">187: </a><span class="php-comment">     * The content inside the regex can contain characters that may be confused
</span></span><span id="188" class="l"><a href="#188">188: </a><span class="php-comment">     * for JS code: e.g. it could contain whitespace it needs to match &amp; we
</span></span><span id="189" class="l"><a href="#189">189: </a><span class="php-comment">     * don't want to strip whitespace in there.
</span></span><span id="190" class="l"><a href="#190">190: </a><span class="php-comment">     *
</span></span><span id="191" class="l"><a href="#191">191: </a><span class="php-comment">     * The regex can be pretty simple: we don't have to care about comments,
</span></span><span id="192" class="l"><a href="#192">192: </a><span class="php-comment">     * (which also use slashes) because stripComments() will have stripped those
</span></span><span id="193" class="l"><a href="#193">193: </a><span class="php-comment">     * already.
</span></span><span id="194" class="l"><a href="#194">194: </a><span class="php-comment">     *
</span></span><span id="195" class="l"><a href="#195">195: </a><span class="php-comment">     * This method will replace all string content with simple REGEX#
</span></span><span id="196" class="l"><a href="#196">196: </a><span class="php-comment">     * placeholder text, so we've rid all regular expressions from characters
</span></span><span id="197" class="l"><a href="#197">197: </a><span class="php-comment">     * that may be misinterpreted. Original regex content will be saved in
</span></span><span id="198" class="l"><a href="#198">198: </a><span class="php-comment">     * $this-&gt;extracted and after doing all other minifying, we can restore the
</span></span><span id="199" class="l"><a href="#199">199: </a><span class="php-comment">     * original content via restoreRegex()
</span></span><span id="200" class="l"><a href="#200">200: </a><span class="php-comment">     */</span>
</span><span id="201" class="l"><a href="#201">201: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> extractRegex()
</span><span id="202" class="l"><a href="#202">202: </a>    {
</span><span id="203" class="l"><a href="#203">203: </a>        <span class="php-comment">// PHP only supports $this inside anonymous functions since 5.4</span>
</span><span id="204" class="l"><a href="#204">204: </a>        <span class="php-var">$minifier</span> = <span class="php-var">$this</span>;
</span><span id="205" class="l"><a href="#205">205: </a>        <span class="php-var">$callback</span> = <span class="php-keyword1">function</span> (<span class="php-var">$match</span>) <span class="php-keyword1">use</span> (<span class="php-var">$minifier</span>) {
</span><span id="206" class="l"><a href="#206">206: </a>            <span class="php-var">$count</span> = <span class="php-keyword2">count</span>(<span class="php-var">$minifier</span>-&gt;extracted);
</span><span id="207" class="l"><a href="#207">207: </a>            <span class="php-var">$placeholder</span> = <span class="php-quote">'/'</span>.<span class="php-var">$count</span>.<span class="php-quote">'/'</span>;
</span><span id="208" class="l"><a href="#208">208: </a>            <span class="php-var">$minifier</span>-&gt;extracted[<span class="php-var">$placeholder</span>] = <span class="php-var">$match</span>[<span class="php-num">1</span>];
</span><span id="209" class="l"><a href="#209">209: </a>
</span><span id="210" class="l"><a href="#210">210: </a>            <span class="php-keyword1">return</span> <span class="php-var">$placeholder</span>;
</span><span id="211" class="l"><a href="#211">211: </a>        };
</span><span id="212" class="l"><a href="#212">212: </a>
</span><span id="213" class="l"><a href="#213">213: </a>        <span class="php-comment">// it's a regex if we can find an opening and (not escaped) closing /,</span>
</span><span id="214" class="l"><a href="#214">214: </a>        <span class="php-comment">// include \n because it may be there for a reason</span>
</span><span id="215" class="l"><a href="#215">215: </a>        <span class="php-comment">// (https://github.com/matthiasmullie/minify/issues/56)</span>
</span><span id="216" class="l"><a href="#216">216: </a>        <span class="php-var">$pattern</span> = <span class="php-quote">'(\/.*?(?&lt;!\\\\)(\\\\\\\\)*+\/\n?)'</span>;
</span><span id="217" class="l"><a href="#217">217: </a>
</span><span id="218" class="l"><a href="#218">218: </a>        <span class="php-comment">// / can't be preceded by variable, value, or similar because then</span>
</span><span id="219" class="l"><a href="#219">219: </a>        <span class="php-comment">// it's going to be division</span>
</span><span id="220" class="l"><a href="#220">220: </a>        <span class="php-comment">// checking for that is complex, so we'll do inverse:</span>
</span><span id="221" class="l"><a href="#221">221: </a>        <span class="php-comment">// * at the beginning of the file, it's not division, but regex</span>
</span><span id="222" class="l"><a href="#222">222: </a>        <span class="php-var">$this</span>-&gt;registerPattern(<span class="php-quote">'/^\s*\K'</span>.<span class="php-var">$pattern</span>.<span class="php-quote">'/'</span>, <span class="php-var">$callback</span>);
</span><span id="223" class="l"><a href="#223">223: </a>        <span class="php-comment">// * following another operator, it's not division, but regex</span>
</span><span id="224" class="l"><a href="#224">224: </a>        <span class="php-var">$operators</span> = <span class="php-var">$this</span>-&gt;getOperatorsForRegex(<span class="php-var">$this</span>-&gt;operatorsBefore, <span class="php-quote">'/'</span>);
</span><span id="225" class="l"><a href="#225">225: </a>        <span class="php-var">$operators</span> += <span class="php-var">$this</span>-&gt;getKeywordsForRegex(<span class="php-var">$this</span>-&gt;keywordsReserved, <span class="php-quote">'/'</span>);
</span><span id="226" class="l"><a href="#226">226: </a>        <span class="php-var">$this</span>-&gt;registerPattern(<span class="php-quote">'/(?:'</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$operators</span>).<span class="php-quote">')\s*\K'</span>.<span class="php-var">$pattern</span>.<span class="php-quote">'/'</span>, <span class="php-var">$callback</span>);
</span><span id="227" class="l"><a href="#227">227: </a>    }
</span><span id="228" class="l"><a href="#228">228: </a>
</span><span id="229" class="l"><a href="#229">229: </a>    <span class="php-comment">/**
</span></span><span id="230" class="l"><a href="#230">230: </a><span class="php-comment">     * Strip whitespace.
</span></span><span id="231" class="l"><a href="#231">231: </a><span class="php-comment">     *
</span></span><span id="232" class="l"><a href="#232">232: </a><span class="php-comment">     * We won't strip *all* whitespace, but as much as possible. The thing that
</span></span><span id="233" class="l"><a href="#233">233: </a><span class="php-comment">     * we'll preserve are newlines we're unsure about.
</span></span><span id="234" class="l"><a href="#234">234: </a><span class="php-comment">     * JavaScript doesn't require statements to be terminated with a semicolon.
</span></span><span id="235" class="l"><a href="#235">235: </a><span class="php-comment">     * It will automatically fix missing semicolons with ASI (automatic semi-
</span></span><span id="236" class="l"><a href="#236">236: </a><span class="php-comment">     * colon insertion) at the end of line causing errors (without semicolon.)
</span></span><span id="237" class="l"><a href="#237">237: </a><span class="php-comment">     *
</span></span><span id="238" class="l"><a href="#238">238: </a><span class="php-comment">     * Because it's sometimes hard to tell if a newline is part of a statement
</span></span><span id="239" class="l"><a href="#239">239: </a><span class="php-comment">     * that should be terminated or not, we'll just leave some of them alone.
</span></span><span id="240" class="l"><a href="#240">240: </a><span class="php-comment">     *
</span></span><span id="241" class="l"><a href="#241">241: </a><span class="php-comment">     * @param string $content The content to strip the whitespace for.
</span></span><span id="242" class="l"><a href="#242">242: </a><span class="php-comment">     *
</span></span><span id="243" class="l"><a href="#243">243: </a><span class="php-comment">     * @return string
</span></span><span id="244" class="l"><a href="#244">244: </a><span class="php-comment">     */</span>
</span><span id="245" class="l"><a href="#245">245: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> stripWhitespace(<span class="php-var">$content</span>)
</span><span id="246" class="l"><a href="#246">246: </a>    {
</span><span id="247" class="l"><a href="#247">247: </a>        <span class="php-comment">// uniform line endings, make them all line feed</span>
</span><span id="248" class="l"><a href="#248">248: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">str_replace</span>(<span class="php-keyword1">array</span>(<span class="php-quote">&quot;\r\n&quot;</span>, <span class="php-quote">&quot;\r&quot;</span>), <span class="php-quote">&quot;\n&quot;</span>, <span class="php-var">$content</span>);
</span><span id="249" class="l"><a href="#249">249: </a>
</span><span id="250" class="l"><a href="#250">250: </a>        <span class="php-comment">// collapse all non-line feed whitespace into a single space</span>
</span><span id="251" class="l"><a href="#251">251: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/[^\S\n]+/'</span>, <span class="php-quote">' '</span>, <span class="php-var">$content</span>);
</span><span id="252" class="l"><a href="#252">252: </a>
</span><span id="253" class="l"><a href="#253">253: </a>        <span class="php-comment">// strip leading &amp; trailing whitespace</span>
</span><span id="254" class="l"><a href="#254">254: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">str_replace</span>(<span class="php-keyword1">array</span>(<span class="php-quote">&quot; \n&quot;</span>, <span class="php-quote">&quot;\n &quot;</span>), <span class="php-quote">&quot;\n&quot;</span>, <span class="php-var">$content</span>);
</span><span id="255" class="l"><a href="#255">255: </a>
</span><span id="256" class="l"><a href="#256">256: </a>        <span class="php-comment">// collapse consecutive line feeds into just 1</span>
</span><span id="257" class="l"><a href="#257">257: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\n+/'</span>, <span class="php-quote">&quot;\n&quot;</span>, <span class="php-var">$content</span>);
</span><span id="258" class="l"><a href="#258">258: </a>
</span><span id="259" class="l"><a href="#259">259: </a>        <span class="php-var">$before</span> = <span class="php-var">$this</span>-&gt;getOperatorsForRegex(<span class="php-var">$this</span>-&gt;operatorsBefore, <span class="php-quote">'/'</span>);
</span><span id="260" class="l"><a href="#260">260: </a>        <span class="php-var">$after</span> = <span class="php-var">$this</span>-&gt;getOperatorsForRegex(<span class="php-var">$this</span>-&gt;operatorsAfter, <span class="php-quote">'/'</span>);
</span><span id="261" class="l"><a href="#261">261: </a>        <span class="php-var">$operators</span> = <span class="php-var">$before</span> + <span class="php-var">$after</span>;
</span><span id="262" class="l"><a href="#262">262: </a>
</span><span id="263" class="l"><a href="#263">263: </a>        <span class="php-comment">// strip whitespace that ends in (or next line begin with) an operator</span>
</span><span id="264" class="l"><a href="#264">264: </a>        <span class="php-comment">// that allows statements to be broken up over multiple lines</span>
</span><span id="265" class="l"><a href="#265">265: </a>        <span class="php-keyword1">unset</span>(<span class="php-var">$before</span>[<span class="php-quote">'+'</span>], <span class="php-var">$before</span>[<span class="php-quote">'-'</span>], <span class="php-var">$after</span>[<span class="php-quote">'+'</span>], <span class="php-var">$after</span>[<span class="php-quote">'-'</span>]);
</span><span id="266" class="l"><a href="#266">266: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(
</span><span id="267" class="l"><a href="#267">267: </a>            <span class="php-keyword1">array</span>(
</span><span id="268" class="l"><a href="#268">268: </a>                <span class="php-quote">'/('</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$before</span>).<span class="php-quote">')\s+/'</span>,
</span><span id="269" class="l"><a href="#269">269: </a>                <span class="php-quote">'/\s+('</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$after</span>).<span class="php-quote">')/'</span>,
</span><span id="270" class="l"><a href="#270">270: </a>            ), <span class="php-quote">'\\1'</span>, <span class="php-var">$content</span>
</span><span id="271" class="l"><a href="#271">271: </a>        );
</span><span id="272" class="l"><a href="#272">272: </a>
</span><span id="273" class="l"><a href="#273">273: </a>        <span class="php-comment">// make sure + and - can't be mistaken for, or joined into ++ and --</span>
</span><span id="274" class="l"><a href="#274">274: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(
</span><span id="275" class="l"><a href="#275">275: </a>            <span class="php-keyword1">array</span>(
</span><span id="276" class="l"><a href="#276">276: </a>                <span class="php-quote">'/(?&lt;![\+\-])\s*([\+\-])(?![\+\-])/'</span>,
</span><span id="277" class="l"><a href="#277">277: </a>                <span class="php-quote">'/(?&lt;![\+\-])([\+\-])\s*(?![\+\-])/'</span>,
</span><span id="278" class="l"><a href="#278">278: </a>            ), <span class="php-quote">'\\1'</span>, <span class="php-var">$content</span>
</span><span id="279" class="l"><a href="#279">279: </a>        );
</span><span id="280" class="l"><a href="#280">280: </a>
</span><span id="281" class="l"><a href="#281">281: </a>        <span class="php-comment">/*
</span></span><span id="282" class="l"><a href="#282">282: </a><span class="php-comment">         * We didn't strip whitespace after a couple of operators because they
</span></span><span id="283" class="l"><a href="#283">283: </a><span class="php-comment">         * could be used in different contexts and we can't be sure it's ok to
</span></span><span id="284" class="l"><a href="#284">284: </a><span class="php-comment">         * strip the newlines. However, we can safely strip any non-line feed
</span></span><span id="285" class="l"><a href="#285">285: </a><span class="php-comment">         * whitespace that follows them.
</span></span><span id="286" class="l"><a href="#286">286: </a><span class="php-comment">         */</span>
</span><span id="287" class="l"><a href="#287">287: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/([\}\)\]])[^\S\n]+(?!'</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$operators</span>).<span class="php-quote">')/'</span>, <span class="php-quote">'\\1'</span>, <span class="php-var">$content</span>);
</span><span id="288" class="l"><a href="#288">288: </a>
</span><span id="289" class="l"><a href="#289">289: </a>        <span class="php-comment">// collapse whitespace around reserved words into single space</span>
</span><span id="290" class="l"><a href="#290">290: </a>        <span class="php-var">$before</span> = <span class="php-var">$this</span>-&gt;getKeywordsForRegex(<span class="php-var">$this</span>-&gt;keywordsBefore, <span class="php-quote">'/'</span>);
</span><span id="291" class="l"><a href="#291">291: </a>        <span class="php-var">$after</span> = <span class="php-var">$this</span>-&gt;getKeywordsForRegex(<span class="php-var">$this</span>-&gt;keywordsAfter, <span class="php-quote">'/'</span>);
</span><span id="292" class="l"><a href="#292">292: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/(^|[;\}\s])\K('</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$before</span>).<span class="php-quote">')\s+/'</span>, <span class="php-quote">'\\2 '</span>, <span class="php-var">$content</span>);
</span><span id="293" class="l"><a href="#293">293: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\s+('</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$after</span>).<span class="php-quote">')(?=([;\{\s]|$))/'</span>, <span class="php-quote">' \\1'</span>, <span class="php-var">$content</span>);
</span><span id="294" class="l"><a href="#294">294: </a>
</span><span id="295" class="l"><a href="#295">295: </a>        <span class="php-comment">/*
</span></span><span id="296" class="l"><a href="#296">296: </a><span class="php-comment">         * Get rid of double semicolons, except where they can be used like:
</span></span><span id="297" class="l"><a href="#297">297: </a><span class="php-comment">         * &quot;for(v=1,_=b;;)&quot;, &quot;for(v=1;;v++)&quot; or &quot;for(;;ja||(ja=true))&quot;.
</span></span><span id="298" class="l"><a href="#298">298: </a><span class="php-comment">         * I'll safeguard these double semicolons inside for-loops by
</span></span><span id="299" class="l"><a href="#299">299: </a><span class="php-comment">         * temporarily replacing them with an invalid condition: they won't have
</span></span><span id="300" class="l"><a href="#300">300: </a><span class="php-comment">         * a double semicolon and will be easy to spot to restore afterwards.
</span></span><span id="301" class="l"><a href="#301">301: </a><span class="php-comment">         */</span>
</span><span id="302" class="l"><a href="#302">302: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\bfor\(([^;]*);;([^;]*)\)/'</span>, <span class="php-quote">'for(\\1;-;\\2)'</span>, <span class="php-var">$content</span>);
</span><span id="303" class="l"><a href="#303">303: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/;+/'</span>, <span class="php-quote">';'</span>, <span class="php-var">$content</span>);
</span><span id="304" class="l"><a href="#304">304: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\bfor\(([^;]*);-;([^;]*)\)/'</span>, <span class="php-quote">'for(\\1;;\\2)'</span>, <span class="php-var">$content</span>);
</span><span id="305" class="l"><a href="#305">305: </a>
</span><span id="306" class="l"><a href="#306">306: </a>        <span class="php-comment">/*
</span></span><span id="307" class="l"><a href="#307">307: </a><span class="php-comment">         * Next, we'll be removing all semicolons where ASI kicks in.
</span></span><span id="308" class="l"><a href="#308">308: </a><span class="php-comment">         * for-loops however, can have an empty body (ending in only a
</span></span><span id="309" class="l"><a href="#309">309: </a><span class="php-comment">         * semicolon), like: `for(i=1;i&lt;3;i++);`
</span></span><span id="310" class="l"><a href="#310">310: </a><span class="php-comment">         * Here, nothing happens during the loop; it's just used to keep
</span></span><span id="311" class="l"><a href="#311">311: </a><span class="php-comment">         * increasing `i`. With that ; omitted, the next line would be expected
</span></span><span id="312" class="l"><a href="#312">312: </a><span class="php-comment">         * to be the for-loop's body...
</span></span><span id="313" class="l"><a href="#313">313: </a><span class="php-comment">         * I'm going to double that semicolon (if any) so after the next line,
</span></span><span id="314" class="l"><a href="#314">314: </a><span class="php-comment">         * which strips semicolons here &amp; there, we're still left with this one.
</span></span><span id="315" class="l"><a href="#315">315: </a><span class="php-comment">         */</span>
</span><span id="316" class="l"><a href="#316">316: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/(for\([^;]*;[^;]*;[^;\{]*\));(\}|$)/s'</span>, <span class="php-quote">'\\1;;\\2'</span>, <span class="php-var">$content</span>);
</span><span id="317" class="l"><a href="#317">317: </a>
</span><span id="318" class="l"><a href="#318">318: </a>        <span class="php-comment">/*
</span></span><span id="319" class="l"><a href="#319">319: </a><span class="php-comment">         * We also can't strip empty else-statements. Even though they're
</span></span><span id="320" class="l"><a href="#320">320: </a><span class="php-comment">         * useless and probably shouldn't be in the code in the first place, we
</span></span><span id="321" class="l"><a href="#321">321: </a><span class="php-comment">         * shouldn't be stripping the `;` that follows it as it breaks the code.
</span></span><span id="322" class="l"><a href="#322">322: </a><span class="php-comment">         * We can just remove those useless else-statements completely.
</span></span><span id="323" class="l"><a href="#323">323: </a><span class="php-comment">         *
</span></span><span id="324" class="l"><a href="#324">324: </a><span class="php-comment">         * @see https://github.com/matthiasmullie/minify/issues/91
</span></span><span id="325" class="l"><a href="#325">325: </a><span class="php-comment">         */</span>
</span><span id="326" class="l"><a href="#326">326: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/else;/s'</span>, <span class="php-quote">''</span>, <span class="php-var">$content</span>);
</span><span id="327" class="l"><a href="#327">327: </a>
</span><span id="328" class="l"><a href="#328">328: </a>        <span class="php-comment">/*
</span></span><span id="329" class="l"><a href="#329">329: </a><span class="php-comment">         * We also don't really want to terminate statements followed by closing
</span></span><span id="330" class="l"><a href="#330">330: </a><span class="php-comment">         * curly braces (which we've ignored completely up until now) or end-of-
</span></span><span id="331" class="l"><a href="#331">331: </a><span class="php-comment">         * script: ASI will kick in here &amp; we're all about minifying.
</span></span><span id="332" class="l"><a href="#332">332: </a><span class="php-comment">         * Semicolons at beginning of the file don't make any sense either.
</span></span><span id="333" class="l"><a href="#333">333: </a><span class="php-comment">         */</span>
</span><span id="334" class="l"><a href="#334">334: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/;(\}|$)/s'</span>, <span class="php-quote">'\\1'</span>, <span class="php-var">$content</span>);
</span><span id="335" class="l"><a href="#335">335: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">ltrim</span>(<span class="php-var">$content</span>, <span class="php-quote">';'</span>);
</span><span id="336" class="l"><a href="#336">336: </a>
</span><span id="337" class="l"><a href="#337">337: </a>        <span class="php-comment">// get rid of remaining whitespace af beginning/end</span>
</span><span id="338" class="l"><a href="#338">338: </a>        <span class="php-keyword1">return</span> <span class="php-keyword2">trim</span>(<span class="php-var">$content</span>);
</span><span id="339" class="l"><a href="#339">339: </a>    }
</span><span id="340" class="l"><a href="#340">340: </a>
</span><span id="341" class="l"><a href="#341">341: </a>    <span class="php-comment">/**
</span></span><span id="342" class="l"><a href="#342">342: </a><span class="php-comment">     * We'll strip whitespace around certain operators with regular expressions.
</span></span><span id="343" class="l"><a href="#343">343: </a><span class="php-comment">     * This will prepare the given array by escaping all characters.
</span></span><span id="344" class="l"><a href="#344">344: </a><span class="php-comment">     *
</span></span><span id="345" class="l"><a href="#345">345: </a><span class="php-comment">     * @param string[] $operators
</span></span><span id="346" class="l"><a href="#346">346: </a><span class="php-comment">     * @param string   $delimiter
</span></span><span id="347" class="l"><a href="#347">347: </a><span class="php-comment">     *
</span></span><span id="348" class="l"><a href="#348">348: </a><span class="php-comment">     * @return string[]
</span></span><span id="349" class="l"><a href="#349">349: </a><span class="php-comment">     */</span>
</span><span id="350" class="l"><a href="#350">350: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> getOperatorsForRegex(<span class="php-keyword1">array</span> <span class="php-var">$operators</span>, <span class="php-var">$delimiter</span> = <span class="php-quote">'/'</span>)
</span><span id="351" class="l"><a href="#351">351: </a>    {
</span><span id="352" class="l"><a href="#352">352: </a>        <span class="php-comment">// escape operators for use in regex</span>
</span><span id="353" class="l"><a href="#353">353: </a>        <span class="php-var">$delimiter</span> = <span class="php-keyword2">array_fill</span>(<span class="php-num">0</span>, <span class="php-keyword2">count</span>(<span class="php-var">$operators</span>), <span class="php-var">$delimiter</span>);
</span><span id="354" class="l"><a href="#354">354: </a>        <span class="php-var">$escaped</span> = <span class="php-keyword2">array_map</span>(<span class="php-quote">'preg_quote'</span>, <span class="php-var">$operators</span>, <span class="php-var">$delimiter</span>);
</span><span id="355" class="l"><a href="#355">355: </a>
</span><span id="356" class="l"><a href="#356">356: </a>        <span class="php-var">$operators</span> = <span class="php-keyword2">array_combine</span>(<span class="php-var">$operators</span>, <span class="php-var">$escaped</span>);
</span><span id="357" class="l"><a href="#357">357: </a>
</span><span id="358" class="l"><a href="#358">358: </a>        <span class="php-comment">// ignore + &amp; - for now, they'll get special treatment</span>
</span><span id="359" class="l"><a href="#359">359: </a>        <span class="php-keyword1">unset</span>(<span class="php-var">$operators</span>[<span class="php-quote">'+'</span>], <span class="php-var">$operators</span>[<span class="php-quote">'-'</span>]);
</span><span id="360" class="l"><a href="#360">360: </a>
</span><span id="361" class="l"><a href="#361">361: </a>        <span class="php-comment">// dot can not just immediately follow a number; it can be confused for</span>
</span><span id="362" class="l"><a href="#362">362: </a>        <span class="php-comment">// decimal point, or calling a method on it, e.g. 42 .toString()</span>
</span><span id="363" class="l"><a href="#363">363: </a>        <span class="php-var">$operators</span>[<span class="php-quote">'.'</span>] = <span class="php-quote">'(?&lt;![0-9]\s)\.'</span>;
</span><span id="364" class="l"><a href="#364">364: </a>
</span><span id="365" class="l"><a href="#365">365: </a>        <span class="php-comment">// don't confuse = with other assignment shortcuts (e.g. +=)</span>
</span><span id="366" class="l"><a href="#366">366: </a>        <span class="php-var">$chars</span> = <span class="php-keyword2">preg_quote</span>(<span class="php-quote">'+-*\=&lt;&gt;%&amp;|'</span>);
</span><span id="367" class="l"><a href="#367">367: </a>        <span class="php-var">$operators</span>[<span class="php-quote">'='</span>] = <span class="php-quote">'(?&lt;!['</span>.<span class="php-var">$chars</span>.<span class="php-quote">'])\='</span>;
</span><span id="368" class="l"><a href="#368">368: </a>
</span><span id="369" class="l"><a href="#369">369: </a>        <span class="php-keyword1">return</span> <span class="php-var">$operators</span>;
</span><span id="370" class="l"><a href="#370">370: </a>    }
</span><span id="371" class="l"><a href="#371">371: </a>
</span><span id="372" class="l"><a href="#372">372: </a>    <span class="php-comment">/**
</span></span><span id="373" class="l"><a href="#373">373: </a><span class="php-comment">     * We'll strip whitespace around certain keywords with regular expressions.
</span></span><span id="374" class="l"><a href="#374">374: </a><span class="php-comment">     * This will prepare the given array by escaping all characters.
</span></span><span id="375" class="l"><a href="#375">375: </a><span class="php-comment">     *
</span></span><span id="376" class="l"><a href="#376">376: </a><span class="php-comment">     * @param string[] $keywords
</span></span><span id="377" class="l"><a href="#377">377: </a><span class="php-comment">     * @param string   $delimiter
</span></span><span id="378" class="l"><a href="#378">378: </a><span class="php-comment">     *
</span></span><span id="379" class="l"><a href="#379">379: </a><span class="php-comment">     * @return string[]
</span></span><span id="380" class="l"><a href="#380">380: </a><span class="php-comment">     */</span>
</span><span id="381" class="l"><a href="#381">381: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> getKeywordsForRegex(<span class="php-keyword1">array</span> <span class="php-var">$keywords</span>, <span class="php-var">$delimiter</span> = <span class="php-quote">'/'</span>)
</span><span id="382" class="l"><a href="#382">382: </a>    {
</span><span id="383" class="l"><a href="#383">383: </a>        <span class="php-comment">// escape keywords for use in regex</span>
</span><span id="384" class="l"><a href="#384">384: </a>        <span class="php-var">$delimiter</span> = <span class="php-keyword2">array_fill</span>(<span class="php-num">0</span>, <span class="php-keyword2">count</span>(<span class="php-var">$keywords</span>), <span class="php-var">$delimiter</span>);
</span><span id="385" class="l"><a href="#385">385: </a>        <span class="php-var">$escaped</span> = <span class="php-keyword2">array_map</span>(<span class="php-quote">'preg_quote'</span>, <span class="php-var">$keywords</span>, <span class="php-var">$delimiter</span>);
</span><span id="386" class="l"><a href="#386">386: </a>
</span><span id="387" class="l"><a href="#387">387: </a>        <span class="php-comment">// add word boundaries</span>
</span><span id="388" class="l"><a href="#388">388: </a>        <span class="php-keyword2">array_walk</span>(<span class="php-var">$keywords</span>, <span class="php-keyword1">function</span> (<span class="php-var">$value</span>) {
</span><span id="389" class="l"><a href="#389">389: </a>            <span class="php-keyword1">return</span> <span class="php-quote">'\b'</span>.<span class="php-var">$value</span>.<span class="php-quote">'\b'</span>;
</span><span id="390" class="l"><a href="#390">390: </a>        });
</span><span id="391" class="l"><a href="#391">391: </a>
</span><span id="392" class="l"><a href="#392">392: </a>        <span class="php-var">$keywords</span> = <span class="php-keyword2">array_combine</span>(<span class="php-var">$keywords</span>, <span class="php-var">$escaped</span>);
</span><span id="393" class="l"><a href="#393">393: </a>
</span><span id="394" class="l"><a href="#394">394: </a>        <span class="php-keyword1">return</span> <span class="php-var">$keywords</span>;
</span><span id="395" class="l"><a href="#395">395: </a>    }
</span><span id="396" class="l"><a href="#396">396: </a>
</span><span id="397" class="l"><a href="#397">397: </a>    <span class="php-comment">/**
</span></span><span id="398" class="l"><a href="#398">398: </a><span class="php-comment">     * Replaces all occurrences of array['key'] by array.key.
</span></span><span id="399" class="l"><a href="#399">399: </a><span class="php-comment">     *
</span></span><span id="400" class="l"><a href="#400">400: </a><span class="php-comment">     * @param string $content
</span></span><span id="401" class="l"><a href="#401">401: </a><span class="php-comment">     *
</span></span><span id="402" class="l"><a href="#402">402: </a><span class="php-comment">     * @return string
</span></span><span id="403" class="l"><a href="#403">403: </a><span class="php-comment">     */</span>
</span><span id="404" class="l"><a href="#404">404: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> propertyNotation(<span class="php-var">$content</span>)
</span><span id="405" class="l"><a href="#405">405: </a>    {
</span><span id="406" class="l"><a href="#406">406: </a>        <span class="php-comment">// PHP only supports $this inside anonymous functions since 5.4</span>
</span><span id="407" class="l"><a href="#407">407: </a>        <span class="php-var">$minifier</span> = <span class="php-var">$this</span>;
</span><span id="408" class="l"><a href="#408">408: </a>        <span class="php-var">$keywords</span> = <span class="php-var">$this</span>-&gt;keywordsReserved;
</span><span id="409" class="l"><a href="#409">409: </a>        <span class="php-var">$callback</span> = <span class="php-keyword1">function</span> (<span class="php-var">$match</span>) <span class="php-keyword1">use</span> (<span class="php-var">$minifier</span>, <span class="php-var">$keywords</span>) {
</span><span id="410" class="l"><a href="#410">410: </a>            <span class="php-var">$property</span> = <span class="php-keyword2">trim</span>(<span class="php-var">$minifier</span>-&gt;extracted[<span class="php-var">$match</span>[<span class="php-num">1</span>]], <span class="php-quote">'\'&quot;'</span>);
</span><span id="411" class="l"><a href="#411">411: </a>
</span><span id="412" class="l"><a href="#412">412: </a>            <span class="php-comment">/*
</span></span><span id="413" class="l"><a href="#413">413: </a><span class="php-comment">             * Check if the property is a reserved keyword. In this context (as
</span></span><span id="414" class="l"><a href="#414">414: </a><span class="php-comment">             * property of an object literal/array) it shouldn't matter, but IE8
</span></span><span id="415" class="l"><a href="#415">415: </a><span class="php-comment">             * freaks out with &quot;Expected identifier&quot;.
</span></span><span id="416" class="l"><a href="#416">416: </a><span class="php-comment">             */</span>
</span><span id="417" class="l"><a href="#417">417: </a>            <span class="php-keyword1">if</span> (<span class="php-keyword2">in_array</span>(<span class="php-var">$property</span>, <span class="php-var">$keywords</span>)) {
</span><span id="418" class="l"><a href="#418">418: </a>                <span class="php-keyword1">return</span> <span class="php-var">$match</span>[<span class="php-num">0</span>];
</span><span id="419" class="l"><a href="#419">419: </a>            }
</span><span id="420" class="l"><a href="#420">420: </a>
</span><span id="421" class="l"><a href="#421">421: </a>            <span class="php-comment">/*
</span></span><span id="422" class="l"><a href="#422">422: </a><span class="php-comment">             * See if the property is in a variable-like format (e.g.
</span></span><span id="423" class="l"><a href="#423">423: </a><span class="php-comment">             * array['key-here'] can't be replaced by array.key-here since '-'
</span></span><span id="424" class="l"><a href="#424">424: </a><span class="php-comment">             * is not a valid character there.
</span></span><span id="425" class="l"><a href="#425">425: </a><span class="php-comment">             */</span>
</span><span id="426" class="l"><a href="#426">426: </a>            <span class="php-keyword1">if</span> (!<span class="php-keyword2">preg_match</span>(<span class="php-quote">'/^'</span>.<span class="php-var">$minifier</span>::REGEX_VARIABLE.<span class="php-quote">'$/u'</span>, <span class="php-var">$property</span>)) {
</span><span id="427" class="l"><a href="#427">427: </a>                <span class="php-keyword1">return</span> <span class="php-var">$match</span>[<span class="php-num">0</span>];
</span><span id="428" class="l"><a href="#428">428: </a>            }
</span><span id="429" class="l"><a href="#429">429: </a>
</span><span id="430" class="l"><a href="#430">430: </a>            <span class="php-keyword1">return</span> <span class="php-quote">'.'</span>.<span class="php-var">$property</span>;
</span><span id="431" class="l"><a href="#431">431: </a>        };
</span><span id="432" class="l"><a href="#432">432: </a>
</span><span id="433" class="l"><a href="#433">433: </a>        <span class="php-comment">/*
</span></span><span id="434" class="l"><a href="#434">434: </a><span class="php-comment">         * Figure out if previous character is a variable name (of the array
</span></span><span id="435" class="l"><a href="#435">435: </a><span class="php-comment">         * we want to use property notation on) - this is to make sure
</span></span><span id="436" class="l"><a href="#436">436: </a><span class="php-comment">         * standalone ['value'] arrays aren't confused for keys-of-an-array.
</span></span><span id="437" class="l"><a href="#437">437: </a><span class="php-comment">         * We can (and only have to) check the last character, because PHP's
</span></span><span id="438" class="l"><a href="#438">438: </a><span class="php-comment">         * regex implementation doesn't allow unfixed-length look-behind
</span></span><span id="439" class="l"><a href="#439">439: </a><span class="php-comment">         * assertions.
</span></span><span id="440" class="l"><a href="#440">440: </a><span class="php-comment">         */</span>
</span><span id="441" class="l"><a href="#441">441: </a>        <span class="php-keyword2">preg_match</span>(<span class="php-quote">'/(\[[^\]]+\])[^\]]*$/'</span>, <span class="php-keyword1">static</span>::REGEX_VARIABLE, <span class="php-var">$previousChar</span>);
</span><span id="442" class="l"><a href="#442">442: </a>        <span class="php-var">$previousChar</span> = <span class="php-var">$previousChar</span>[<span class="php-num">1</span>];
</span><span id="443" class="l"><a href="#443">443: </a>
</span><span id="444" class="l"><a href="#444">444: </a>        <span class="php-comment">/*
</span></span><span id="445" class="l"><a href="#445">445: </a><span class="php-comment">         * Make sure word preceding the ['value'] is not a keyword, e.g.
</span></span><span id="446" class="l"><a href="#446">446: </a><span class="php-comment">         * return['x']. Because -again- PHP's regex implementation doesn't allow
</span></span><span id="447" class="l"><a href="#447">447: </a><span class="php-comment">         * unfixed-length look-behind assertions, I'm just going to do a lot of
</span></span><span id="448" class="l"><a href="#448">448: </a><span class="php-comment">         * separate look-behind assertions, one for each keyword.
</span></span><span id="449" class="l"><a href="#449">449: </a><span class="php-comment">         */</span>
</span><span id="450" class="l"><a href="#450">450: </a>        <span class="php-var">$keywords</span> = <span class="php-var">$this</span>-&gt;getKeywordsForRegex(<span class="php-var">$keywords</span>);
</span><span id="451" class="l"><a href="#451">451: </a>        <span class="php-var">$keywords</span> = <span class="php-quote">'(?&lt;!'</span>.<span class="php-keyword2">implode</span>(<span class="php-quote">')(?&lt;!'</span>, <span class="php-var">$keywords</span>).<span class="php-quote">')'</span>;
</span><span id="452" class="l"><a href="#452">452: </a>
</span><span id="453" class="l"><a href="#453">453: </a>        <span class="php-keyword1">return</span> <span class="php-keyword2">preg_replace_callback</span>(<span class="php-quote">'/(?&lt;='</span>.<span class="php-var">$previousChar</span>.<span class="php-quote">'|\])'</span>.<span class="php-var">$keywords</span>.<span class="php-quote">'\[(([\'&quot;])[0-9]+\\2)\]/u'</span>, <span class="php-var">$callback</span>, <span class="php-var">$content</span>);
</span><span id="454" class="l"><a href="#454">454: </a>    }
</span><span id="455" class="l"><a href="#455">455: </a>
</span><span id="456" class="l"><a href="#456">456: </a>    <span class="php-comment">/**
</span></span><span id="457" class="l"><a href="#457">457: </a><span class="php-comment">     * Replaces true &amp; false by !0 and !1.
</span></span><span id="458" class="l"><a href="#458">458: </a><span class="php-comment">     *
</span></span><span id="459" class="l"><a href="#459">459: </a><span class="php-comment">     * @param string $content
</span></span><span id="460" class="l"><a href="#460">460: </a><span class="php-comment">     *
</span></span><span id="461" class="l"><a href="#461">461: </a><span class="php-comment">     * @return string
</span></span><span id="462" class="l"><a href="#462">462: </a><span class="php-comment">     */</span>
</span><span id="463" class="l"><a href="#463">463: </a>    <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> shortenBools(<span class="php-var">$content</span>)
</span><span id="464" class="l"><a href="#464">464: </a>    {
</span><span id="465" class="l"><a href="#465">465: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\btrue\b/'</span>, <span class="php-quote">'!0'</span>, <span class="php-var">$content</span>);
</span><span id="466" class="l"><a href="#466">466: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\bfalse\b/'</span>, <span class="php-quote">'!1'</span>, <span class="php-var">$content</span>);
</span><span id="467" class="l"><a href="#467">467: </a>
</span><span id="468" class="l"><a href="#468">468: </a>        <span class="php-comment">// for(;;) is exactly the same as while(true)</span>
</span><span id="469" class="l"><a href="#469">469: </a>        <span class="php-var">$content</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/\bwhile\(!0\){/'</span>, <span class="php-quote">'for(;;){'</span>, <span class="php-var">$content</span>);
</span><span id="470" class="l"><a href="#470">470: </a>
</span><span id="471" class="l"><a href="#471">471: </a>        <span class="php-comment">// now make sure we didn't turn any do ... while(true) into do ... for(;;)</span>
</span><span id="472" class="l"><a href="#472">472: </a>        <span class="php-keyword2">preg_match_all</span>(<span class="php-quote">'/\bdo\b/'</span>, <span class="php-var">$content</span>, <span class="php-var">$dos</span>, PREG_OFFSET_CAPTURE | PREG_SET_ORDER);
</span><span id="473" class="l"><a href="#473">473: </a>
</span><span id="474" class="l"><a href="#474">474: </a>        <span class="php-comment">// go backward to make sure positional offsets aren't altered when $content changes</span>
</span><span id="475" class="l"><a href="#475">475: </a>        <span class="php-var">$dos</span> = <span class="php-keyword2">array_reverse</span>(<span class="php-var">$dos</span>);
</span><span id="476" class="l"><a href="#476">476: </a>        <span class="php-keyword1">foreach</span> (<span class="php-var">$dos</span> <span class="php-keyword1">as</span> <span class="php-var">$do</span>) {
</span><span id="477" class="l"><a href="#477">477: </a>            <span class="php-var">$offsetDo</span> = <span class="php-var">$do</span>[<span class="php-num">0</span>][<span class="php-num">1</span>];
</span><span id="478" class="l"><a href="#478">478: </a>
</span><span id="479" class="l"><a href="#479">479: </a>            <span class="php-comment">// find all `while` (now `for`) following `do`: one of those must be</span>
</span><span id="480" class="l"><a href="#480">480: </a>            <span class="php-comment">// associated with the `do` and be turned back into `while`</span>
</span><span id="481" class="l"><a href="#481">481: </a>            <span class="php-keyword2">preg_match_all</span>(<span class="php-quote">'/\bfor\(;;\)/'</span>, <span class="php-var">$content</span>, <span class="php-var">$whiles</span>, PREG_OFFSET_CAPTURE | PREG_SET_ORDER, <span class="php-var">$offsetDo</span>);
</span><span id="482" class="l"><a href="#482">482: </a>            <span class="php-keyword1">foreach</span> (<span class="php-var">$whiles</span> <span class="php-keyword1">as</span> <span class="php-var">$while</span>) {
</span><span id="483" class="l"><a href="#483">483: </a>                <span class="php-var">$offsetWhile</span> = <span class="php-var">$while</span>[<span class="php-num">0</span>][<span class="php-num">1</span>];
</span><span id="484" class="l"><a href="#484">484: </a>
</span><span id="485" class="l"><a href="#485">485: </a>                <span class="php-var">$open</span> = <span class="php-keyword2">substr_count</span>(<span class="php-var">$content</span>, <span class="php-quote">'{'</span>, <span class="php-var">$offsetDo</span>, <span class="php-var">$offsetWhile</span> - <span class="php-var">$offsetDo</span>);
</span><span id="486" class="l"><a href="#486">486: </a>                <span class="php-var">$close</span> = <span class="php-keyword2">substr_count</span>(<span class="php-var">$content</span>, <span class="php-quote">'}'</span>, <span class="php-var">$offsetDo</span>, <span class="php-var">$offsetWhile</span> - <span class="php-var">$offsetDo</span>);
</span><span id="487" class="l"><a href="#487">487: </a>                <span class="php-keyword1">if</span> (<span class="php-var">$open</span> === <span class="php-var">$close</span>) {
</span><span id="488" class="l"><a href="#488">488: </a>                    <span class="php-comment">// only restore `while` if amount of `{` and `}` are the same;</span>
</span><span id="489" class="l"><a href="#489">489: </a>                    <span class="php-comment">// otherwise, that `for` isn't associated with this `do`</span>
</span><span id="490" class="l"><a href="#490">490: </a>                    <span class="php-var">$content</span> = <span class="php-keyword2">substr_replace</span>(<span class="php-var">$content</span>, <span class="php-quote">'while(!0)'</span>, <span class="php-var">$offsetWhile</span>, <span class="php-keyword2">strlen</span>(<span class="php-quote">'for(;;)'</span>));
</span><span id="491" class="l"><a href="#491">491: </a>                    <span class="php-keyword1">break</span>;
</span><span id="492" class="l"><a href="#492">492: </a>                }
</span><span id="493" class="l"><a href="#493">493: </a>            }
</span><span id="494" class="l"><a href="#494">494: </a>        }
</span><span id="495" class="l"><a href="#495">495: </a>
</span><span id="496" class="l"><a href="#496">496: </a>        <span class="php-keyword1">return</span> <span class="php-var">$content</span>;
</span><span id="497" class="l"><a href="#497">497: </a>    }
</span><span id="498" class="l"><a href="#498">498: </a>}
</span><span id="499" class="l"><a href="#499">499: </a></span></code></pre>

	<div id="footer">
		 API documentation generated by <a href="http://apigen.org">ApiGen</a>
	</div>
</div>
</div>
<script src="resources/combined.js?cd021bc814832c24a7cec5319ea03335bfba1caf"></script>
<script src="elementlist.js?2a7b35e5d19c824b25dadb37a1fe848ccf90bfe7"></script>
</body>
</html>
